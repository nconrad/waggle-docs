"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9654],{3905:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>p});var i=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=i.createContext({}),c=function(e){var t=i.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},h=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),u=c(a),d=n,p=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return a?i.createElement(p,r(r({ref:t},h),{},{components:a})):i.createElement(p,r({ref:t},h))}));function p(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:n,r[1]=s;for(var c=2;c<o;c++)r[c]=a[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,a)}d.displayName="MDXCreateElement"},4928:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var i=a(7462),n=(a(7294),a(3905));const o={},r="Water Segmentation",s={type:"mdx",permalink:"/sage-website/science/water-segmentation",source:"@site/src/pages/science/water-segmentation.md",title:"Water Segmentation",description:"Water and Our Environment",frontMatter:{}},l=[{value:"Water and Our Environment",id:"water-and-our-environment",level:2},{value:"A Visual Model of Water",id:"a-visual-model-of-water",level:2},{value:"Color",id:"color",level:2},{value:"Texture",id:"texture",level:2},{value:"Motion",id:"motion",level:2},{value:"One Classifier to Rule Them All",id:"one-classifier-to-rule-them-all",level:2},{value:"References",id:"references",level:2}],c={toc:l},h="wrapper";function u(e){let{components:t,...o}=e;return(0,n.kt)(h,(0,i.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"water-segmentation"},"Water Segmentation"),(0,n.kt)("h2",{id:"water-and-our-environment"},"Water and Our Environment"),(0,n.kt)("p",null,"It goes without saying that water is an important part of our environment. Water supports entire ecosystems of animals and is essential to human life. It is one of the most powerful driving forces of nature. But \u2014 as anyone who has fought a losing battling against flooding will tell you \u2014 it can also be a destructive force. Hurricanes and urban flooding can pose serious hazards to the people who live in harm\u2019s way.1 Fortunately, however, we can utilize the power of edge computing to gather insights into the behavior of water to minimize its destruction. The Sage infrastructure will be able to equip hydrologists with the ability to study water in high-risk areas in real time."),(0,n.kt)("p",null,"My name is Luke Jacobs and I am a rising sophmore at the University of Illinois at Urbana-Champaign. My work within Sage has been researching water segmentation with computer vision and machine learning. The end goal of my work is to develop a general-purpose water segmentation tool that will allow Sage nodes to \u201csee\u201d water in their surroundings. Once this algorithm can be deployed onto Sage nodes, domain scientists like hydrologists will be able to gather hourly data on the level of water present in any environment containing a node. This software will be able to provide them with time-series and location-based data on issues like urban flooding to allow them to better understand how water affects our environment."),(0,n.kt)("h2",{id:"a-visual-model-of-water"},"A Visual Model of Water"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"sage node water seg",src:a(1995).Z,width:"902",height:"439"})),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"An image taken from a Sage node in Chicago")),(0,n.kt)("p",null,"An image taken from a Sage node in Chicago\nWhen you look at the above picture, it takes almost no time at all for you to notice the regions of standing water on this field. That\u2019s the way it should be, since \u201chalf of the human brain is devoted directly or indirectly to vision,\u201d explains Professor Mriganka Sur of MIT\u2019s Department of Brain and Cognitive Sciences.2 A task like identifying water is absolutely trivial to us, but to a computer which has no native understanding of 3-dimensional space, teaching it to \u201csee\u201d is a very challenging task. In fact, the above image is one of the hardest for computers to segment (or outline), since it requires an understanding of context, lighting, texture, and color cues all working together."),(0,n.kt)("p",null,"As humans, we draw on numerous visual cues to identify water. In my research, I programmed classifiers for three cues which, when combined, can help computers distinguish between regions of water and other scenery. These cues are color, texture, and motion."),(0,n.kt)("h2",{id:"color"},"Color"),(0,n.kt)("p",null,"For color identification I researched the use of Gaussian Mixture Models.3 This classifier was able to, for each pixel in a given image, output a probability value that that pixel was a water pixel. This initial classifier was a naive but efficient method for filtering out areas in an image that the computer was certain could not contain water. Take the following images, for example:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"segmentation color",src:a(3632).Z,width:"775",height:"451"})),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Two example images and their segmentation outputs (original images taken from the Video Water Database by Mettes, et al. 2015)")),(0,n.kt)("p",null,"The bottom row are input images to the color classifier. The top row images are the segmentation results of the classifier where yellow pixels correspond to a high probability of water and the dark blue pixels correspond to a low probability of water. As you can see in the first row, the classifier was quite easily able to distinguish the buoy from the ocean. However, example images like these are trivial to segment. Segmenting water by color alone would be highly inaccurate, since water can reflect any color. The main role of the color classifier, then, is to flag areas of an image that cannot possibly be water, like the red buoy."),(0,n.kt)("h2",{id:"texture"},"Texture"),(0,n.kt)("p",null,"Because simple color information is not a strong enough cue by itself to classify water spatially, I looked into a texture-based classifier using Local Binary Patterns (LBP\u2019s). Local Binary Patterns are a way of representing an image that highlights its low-level grayscale gradients. In the case of water, this is quite helpful, since ripples and waves in water have distinct texture to them."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"texture",src:a(5053).Z,width:"773",height:"345"})),(0,n.kt)("p",null,"Intuitively, we can look at these images and say that the one on the left is probably an ocean wave and the one on the right might be a puddle. This is because water lies flat on the ground and exhibits ripples. One of the most helpful questions that I have had to ask myself throughout this research has been: How do I know this is water? If I can deduce why my brain thinks what I am looking at is water, then I can program that same line of thinking in a device."),(0,n.kt)("p",null,"Each LBP image segmented by the texture classifier was divided into a number of 10 pixel by 10 pixel blocks, which then were separately classified by a Random Forest classifier. This yielded some good results, albeit with some noise:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"texture",src:a(2489).Z,width:"2048",height:"387"})),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Original images and segmentation masks (original images taken from the Video Water Database by Mettes, et al. 2015)")),(0,n.kt)("p",null,"The black-and-white boxy-looking images represent the predictions of the texture classifier, with the original image to the left. As you can see in the two right-most columns, the classifier can discern a significant difference between a image of a reflection of trees on a pond and an actual image of trees! It is important to have the classifier learn this level of visual subtlety, because it needs to be able to flag reflections as water."),(0,n.kt)("h2",{id:"motion"},"Motion"),(0,n.kt)("p",null,"Color and texture are helpful visual cues of water, but what really sets water apart from other scenery is the way it moves. The motion classifier, proposed by the paper \u201cWater detection through spatio-temporal invariant descriptors,\u201d is the most sophisticated method for water segmentation that I researched. It involves multiple preprocessing steps, which, although relatively computationally expensive, yield impressive segmentation results:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"texture",src:a(1293).Z,width:"2048",height:"507"})),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Original images and segmentation masks (original images taken from the Video Water Database by Mettes, et al. 2015)\nThe motion classifier can draw clear divisions between rivers and their boundaries, since it relies on the pixel-level motion of water to make segmentation predictions. This is helpful in supplementing the texture classifier, which struggles with noise, especially around the boundaries of water bodies.")),(0,n.kt)("p",null,"The motion classifier works by first dividing a set of ~60 grayscale frames into many video \u201cpatches.\u201d Each video patch represents a 3 pixel by 3 pixel space in the video. After the video is broken up into patches, the spatial mean of the grayscale intensity of each patch is computed over the dimension of time. This yields a large number of signals which can then be fed into a discrete fourier transform, the output of which is finally fed into a Random Forest classifier."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"texture",src:a(4324).Z,width:"1099",height:"740"})),(0,n.kt)("p",null,"The purpose of these preprocessing steps is to allow the Random Forest to perceive the specific motion of small regions of a video. It is able to automatically learn the unique visual frequency bands that characterize the ripples and waves in water, allowing it to identify water with only just a second or two of video footage."),(0,n.kt)("h2",{id:"one-classifier-to-rule-them-all"},"One Classifier to Rule Them All"),(0,n.kt)("p",null,"The end goal of water segmentation research is to build a general purpose segmentation algorithm. This algorithm should ideally be able to recognize water in any situation from any perspective with just a second or two of input frames. Although the current algorithm works well on labeled datasets, it is not finished. Future work is necessary to boost its accuracy and implement it on Sage nodes."),(0,n.kt)("p",null,"Water can be a destructive force, but edge computing will make it possible to monitor its behavior and minimize its damage through intelligent sensing."),(0,n.kt)("p",null,"Thanks for reading!"),(0,n.kt)("h2",{id:"references"},"References"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"On average, 1.9 significant flood or torrential rain events occur each year, and $362 million of losses to insured property are incurred each year from such events. (FEMA, ",(0,n.kt)("a",{parentName:"li",href:"https://www.ncbi.nlm.nih.gov/books/NBK541178/"},"https://www.ncbi.nlm.nih.gov/books/NBK541178/"),")"),(0,n.kt)("li",{parentName:"ol"},"Quote found at ",(0,n.kt)("a",{parentName:"li",href:"http://news.mit.edu/1996/visualprocessing"},"http://news.mit.edu/1996/visualprocessing")),(0,n.kt)("li",{parentName:"ol"},"Rankin, A. & Matthies, L.. (2010). Daytime water detection based on color variation. 215 \u2013 221. 10.1109/IROS.2010.5650402."),(0,n.kt)("li",{parentName:"ol"},"Mettes, Pascal & Tan, Robby & Veltkamp, Remco. (2015). Water Detection through Spatio-Temporal Invariant Descriptors. Computer Vision and Image Understanding. 154. 10.1016/j.cviu.2016.04.003.")))}u.isMDXComponent=!0},1995:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-1-e9558ba40250ca5ab9caa22f2d0d9f74.jpg"},3632:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-2-9e93af1a13cbbb961e067336a610f5d5.png"},5053:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-3-5827118e308ee64ae683442db1ae3d1e.png"},2489:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-4-81629a35e43eff835b91b32ebe608663.png"},1293:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-5-1f88204e95b7592c052f8d59154fa0ea.png"},4324:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/water-seg-6-f1f4a1fc14765d9542bd7bf52fb88de1.png"}}]);